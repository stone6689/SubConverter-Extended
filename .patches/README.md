# Subconverter è¡¥ä¸ç®¡ç†

æœ¬ç›®å½•åŒ…å«åœ¨åŒæ­¥ä¸Šæ¸¸ä»£ç åè‡ªåŠ¨åº”ç”¨çš„è¡¥ä¸ï¼ˆpatchesï¼‰ã€‚

## ğŸ“‹ å½“å‰è¡¥ä¸åˆ—è¡¨

### 1. éšè—æŒ‡çº¹è¡¥ä¸
- **æ–‡ä»¶**: `0001-chore-hide-subconverter-fingerprints-when-fetching.patch`
- **ç›®æ ‡æ–‡ä»¶**: `src/handler/webget.cpp`
- **åŠŸèƒ½**: éšè— Subconverter çš„æŒ‡çº¹ç‰¹å¾
  - å°† User-Agent ä» `subconverter/VERSION` ä¿®æ”¹ä¸º `clash.meta`
  - ç§»é™¤ `SubConverter-Request` å’Œ `SubConverter-Version` è¯·æ±‚å¤´
- **åŸå› **: é¿å…éƒ¨åˆ†è®¢é˜…æœåŠ¡å™¨è¯†åˆ«å¹¶å±è”½ Subconverter

### 2. é…ç½®å›é€€é€»è¾‘è¡¥ä¸
- **æ–‡ä»¶**: `0001-feat-improve-external-config-fallback-logic-and-set-.patch`
- **ç›®æ ‡æ–‡ä»¶**: 
  - `src/handler/interfaces.cpp`
  - `base/pref.example.yml`
  - `base/pref.example.ini`
  - `base/pref.example.toml`
- **åŠŸèƒ½**: ä¼˜åŒ–å¤–éƒ¨é…ç½®åŠ è½½æœºåˆ¶
  - å½“ç”¨æˆ·æä¾›çš„é…ç½® URL æ— æ•ˆæ—¶ï¼Œè‡ªåŠ¨å›é€€åˆ°é»˜è®¤é…ç½®
  - è®¾ç½®é»˜è®¤å¤–éƒ¨é…ç½®ä¸ºè‡ªå®šä¹‰ Clash è§„åˆ™ä»“åº“
  - ç¡®ä¿é…ç½®æ€»èƒ½æˆåŠŸåŠ è½½
- **åŸå› **: é˜²æ­¢é”™è¯¯çš„ config å‚æ•°å¯¼è‡´ä½¿ç”¨å†…ç½®é»˜è®¤é…ç½®ï¼Œç¡®ä¿å§‹ç»ˆåº”ç”¨è‡ªå®šä¹‰è§„åˆ™

## ğŸ”„ å·¥ä½œæµç¨‹

sync-upstream.yml å·¥ä½œæµä¼šæŒ‰ä»¥ä¸‹é¡ºåºæ‰§è¡Œï¼š

1. **åŒæ­¥ä¸Šæ¸¸** â†’ `upstream-master` åˆ†æ”¯ï¼ˆçº¯å‡€ä¸Šæ¸¸ä»£ç ï¼‰
2. **Rebase** â†’ å°†ä¸Šæ¸¸æ›´æ–°åº”ç”¨åˆ° `master` åˆ†æ”¯
3. **åº”ç”¨è¡¥ä¸** â†’ è‡ªåŠ¨åº”ç”¨æœ¬ç›®å½•ä¸­çš„æ‰€æœ‰ `.patch` æ–‡ä»¶
4. **æ¢å¤é…ç½®** â†’ æ¢å¤ `.github/` å’Œ `Dockerfile` ç­‰å®šåˆ¶é…ç½®æ–‡ä»¶
5. **æ¨é€** â†’ æ›´æ–°è¿œç¨‹ä»“åº“

## â• æ·»åŠ æ–°è¡¥ä¸

è¦æ·»åŠ æ–°çš„è¡¥ä¸ï¼š

```bash
# 1. åœ¨ master åˆ†æ”¯ä¸Šè¿›è¡Œä¿®æ”¹å¹¶æäº¤
git add <modified-files>
git commit -m "your message"

# 2. ç”Ÿæˆè¡¥ä¸æ–‡ä»¶
git format-patch -1 <commit-hash> -o .patches/

# 3. æäº¤è¡¥ä¸æ–‡ä»¶
git add .patches/
git commit -m "chore: add new patch for <purpose>"
git push
```

## âš ï¸ æ³¨æ„äº‹é¡¹

- è¡¥ä¸æŒ‰**æ–‡ä»¶åå­—å…¸åº**åº”ç”¨
- å¦‚æœè¡¥ä¸åº”ç”¨å¤±è´¥ï¼Œå·¥ä½œæµä¼šè‡ªåŠ¨ä¸­æ­¢å¹¶æ¢å¤çŠ¶æ€
- è¡¥ä¸åªåº”ä¿®æ”¹**æºç æ–‡ä»¶**ï¼Œä¸è¦ä¿®æ”¹ `.github/` æˆ–æ„å»ºé…ç½®æ–‡ä»¶
